# Incident Response and Share Rotation for Compromised MPC Infrastructure

**Last Updated**: 2025-11-29  
**Status**: Draft  
**Owner**: Security Operations Team

## Problem Statement

1. **[CRITICAL]** Q: When one or more MPC key-share servers are compromised or suspected compromised, organizations must detect, analyze, and respond to partial key-share exposure events preventing full key reconstruction or unauthorized signing, while meeting strict timelines for service restoration (RTO <4-8 hours) and regulatory/contractual notifications (e.g., GDPR 72 hours, SOC 2 reporting), but current incident response capabilities struggle with forensics complexity, refresh protocol runtime, and operational coordination across distributed parties. Formulate a structured problem statement using the following [Input] fields.
   
   A:
   - **Brief description of the problem to be analyzed**: 
     MPC wallet providers managing institutional custody ($10M-$1B+ assets per client) face critical incidents when attackers exfiltrate memory or disk snapshots from MPC nodes, potentially exposing key shares without immediately triggering fraud. Organizations must: (1) Detect compromise within <1-2 hours (current: detection often delayed days-weeks until abnormal signing patterns emerge); (2) Contain and rotate affected key shares within <4-8 hours to prevent attacker from collecting threshold shares (current: rotation requires 6-24+ hours coordination across parties); (3) Maintain signing availability for unaffected asset tiers during response (current: often full service suspension); (4) Notify regulators, auditors, and clients within contractual/legal deadlines (GDPR 72 hours, SOC 2 immediate reporting) with accurate scope assessment (current: uncertainty about exposure scope delays notifications). This affects 50+ institutional custody providers, exchanges serving 100M+ users, and enterprise treasury operations where single compromise could enable future theft of billions in assets if threshold shares are collected before rotation completes.
   
   - **Background and current situation**: 
     MPC security relies on threshold property: attacker must compromise k parties in k-of-n threshold to reconstruct signing capability [Guide: Stackup, 2025]. However, partial share exposure creates future risk: attacker exfiltrating memory/disk from one node gains 1-of-3 or 2-of-5 shares; if additional nodes compromised before shares rotated, threshold may be reached enabling unauthorized signing [implied from threat model]. Detection challenges: attackers may exfiltrate data without triggering fraud, leaving providers uncertain whether compromise occurred; scenarios include cloud provider breaches, memory scraping malware, insider threats, and physical server theft [Source: Supplementary]. Industry incidents demonstrate crypto security challenges: $2.2B stolen in 2024, with compromised accounts and private keys as widespread threat vectors [Report: Halborn, 2024]. Key refresh/rotation mechanisms exist: MPC protocols support proactive secret sharing (PSS) where key shares are periodically refreshed without changing public address, maintaining signing capability while invalidating old shares [Guide: Stackup, 2025; Research: Silence Laboratories, 2024]. Regulatory notification timelines: GDPR requires breach notification to authorities within 72 hours of awareness, with additional notification to affected individuals "without undue delay" [Guide: ICO, 2024]. SOC 2 requires incident reporting according to defined procedures, typically immediate notification to oversight and client notification within 24-72 hours depending on severity [implied from SOC 2 requirements]. Incident response complexity: (1) Forensics: determining compromise scope requires analyzing logs, memory dumps, network traffic across distributed infrastructure (3-5 node clusters × multiple environments), often taking 8-24+ hours; (2) Share rotation: distributed key refresh requires all n parties coordinate cryptographic protocol (4-8 rounds communication similar to initial key generation), taking 2-8 hours depending on party availability and network conditions; (3) Service availability: maintaining signing for unaffected assets during response requires sophisticated circuit-breaker logic (pause suspicious addresses/assets, allow others), difficult to implement correctly under time pressure; (4) Notification accuracy: regulatory and client notifications require accurate scope assessment (which key material exposed? which assets at risk?), but uncertainty common during early incident phases [Source: Supplementary]. Organizations struggle with limited on-call and forensic capacity (1-3 security engineers available 24/7), fixed external timelines for formal reports, and risk of introducing new vulnerabilities during emergency procedures [Source: Supplementary].
   
   - **Goals and success criteria**: 
     Detection speed: Compromise detection <1h (min) / <30min (target) / <15min (ideal) from initial intrusion to automated alerting (current: hours to days). Containment timeline: Affected node isolation <1h from detection (target: <30min) preventing attacker from accessing additional infrastructure. Rotation completion: Share refresh completed <8h (min) / <4h (target) / <2h (ideal) from containment decision to new shares operational (current: 6-24+ hours coordination). Service availability: Maintain signing capability for unaffected asset tiers >95% (min) / >99% (target) / >99.9% (ideal) during incident response (current: often full suspension). Realized losses: Zero unauthorized transactions from compromised shares → 0 asset theft (current: compromise detection often too late, losses already incurred). Notification compliance: 100% regulatory notifications (GDPR, SOC 2) submitted within required timelines with accurate scope assessment (current: scope uncertainty delays notifications). Runbook coverage: ≥90% (min) / ≥95% (target) / 100% (ideal) of incident scenarios covered by tested runbooks enabling execution without cryptography expertise by Q4 2025. Post-incident review: Complete incident forensics and root cause analysis <7 days (min) / <3 days (target) / <24h (ideal) from incident closure.
   
   - **Key constraints and resources**: 
     Timeline: Q1 2025 - Q3 2025 (6 months runbook development + monitoring infrastructure + rotation automation + tabletop exercises); Budget: $400K-$800K for security monitoring infrastructure, incident response automation, forensics tools, runbook development, and tabletop exercise facilitation; Team: 2-3 security operations engineers (runbooks, monitoring, on-call), 2-3 cryptography engineers (key refresh protocol implementation), 1-2 forensics specialists (compromise detection, root cause analysis), 1 compliance specialist (regulatory notification templates), 24/7 on-call rotation (3-5 engineers minimum for continuous coverage); Technology: Security monitoring infrastructure (SIEM, EDR, IDS/IPS across MPC infrastructure), automated share refresh orchestration (reduce manual coordination time), forensics tooling (memory analysis, log correlation, timeline reconstruction), communication systems (secure channels for multi-party coordination during incidents), immutable audit trails (evidence preservation for forensics and regulatory reporting); Cryptographic protocols: Key refresh must use proactive secret sharing (PSS) or similar mechanisms enabling share rotation without reconstructing full private key (CGGMP20/21, GG20 with refresh extensions, Shamir secret sharing refresh) [Guide: Stackup, 2025]; Operational limits: Share refresh requires all n parties (or n-1 in some protocols) coordinate protocol execution, introducing dependency on party availability (cloud provider outage, network partition, human response time); Service continuity: Circuit-breaker logic must distinguish affected vs unaffected assets/addresses without administrator expertise (automated risk assessment based on which nodes compromised and which keys used which shares); Communication: Regulatory notification templates must balance accuracy (scope assessment) with timeliness (GDPR 72h deadline), requiring pre-drafted templates with fill-in-the-blank forensics findings; Testing: Runbooks require regular tabletop exercises (quarterly recommended) and live drills (annual) to validate procedures, but live drills risk service disruption if misconfigured.
   
   - **Stakeholders and roles**: 
     Security Operations and Incident Response Teams (5-10 engineers across 24/7 on-call rotation, execute containment and rotation procedures, need clear runbooks and automation, constraint: high-stress environment with <4-8h response window); Cryptography Engineers (2-3 per organization, design and validate share refresh protocols, ensure rotation maintains security properties, constraint: limited availability during off-hours, refresh protocol must not leak key material); SRE and Backend Engineers (3-5 per organization, execute infrastructure isolation and redeployment, maintain service availability during response, constraint: must balance security response with operational stability); Compliance and Legal Teams (1-2 per organization, manage regulatory notifications and documentation, interface with authorities and auditors, constraint: fixed external deadlines—GDPR 72h, SOC 2 immediate/24-72h—and accuracy requirements); Institutional Clients (50+ custody customers managing $10M-$1B+ each, must be notified of incidents affecting their assets, need transparency on exposure scope and remediation status, constraint: reputational and financial risk from breach, may trigger contract termination clauses); Forensics Specialists (1-2 internal + potential external consultants, determine compromise scope and root cause, provide evidence for notifications and post-incident review, constraint: limited time for deep analysis during active incident, must preserve evidence chain for potential legal proceedings); Executive Leadership (CEO, CISO, COO, make strategic decisions during major incidents such as full service shutdown vs partial operation, communicate with board and investors, constraint: balance customer protection vs business continuity); Regulators and Auditors (external parties, receive notifications and conduct post-incident reviews, assess organization's incident response capability, constraint: require evidence of adequate controls and timely notification compliance).
   
   - **Time scale and impact scope**: 
     Timeline: Q1 2025 - Q3 2025 (6 months preparation: runbooks, automation, monitoring, training); Ongoing: continuous operation with quarterly tabletop exercises and annual live drills; Individual incidents: detection to resolution <8h target (current: 6-24+ hours); Systems: MPC key generation and signing infrastructure (3-5 node clusters per environment × multiple environments), security monitoring and alerting (SIEM, EDR, IDS/IPS), share refresh orchestration, communication and coordination platforms, audit trail and forensics systems; Scale: 50+ institutional custody providers, est. $50B+ assets under management globally, 100M+ end users depending on custody services; Incident frequency: unknown (no public statistics on MPC node compromise frequency), but assume 1-5 incidents per large provider per year based on general infrastructure breach rates; Risk: Single mishandled incident can lead to permanent reputational damage, regulatory sanctions (GDPR fines up to €20M or 4% global revenue, SOC 2 certification suspension), or large client departures even if no immediate theft occurred; Worst-case: failure to detect and rotate before threshold shares collected enables unauthorized signing → potential hundreds of millions to billions in asset theft; Post-incident impact: complete forensics and root cause analysis required for audit reports, regulatory filings, and internal process improvements, consuming 40-200 engineering hours over 1-4 weeks; Regions: Global (GDPR in EU, SOC 2 for US/international clients, varying notification requirements across jurisdictions).
   
   - **Historical attempts and existing solutions (if any)**: 
     2018-2020: Early MPC deployments relied on manual incident response procedures and full service shutdown during suspected compromises, achieving containment but causing multi-hour to multi-day outages [implied from operational maturity evolution]. 2020-2022: Basic monitoring infrastructure deployed (log aggregation, basic intrusion detection), but alert tuning challenges created high false-positive rates and delayed true positive detection [implied from security monitoring maturity]. 2022-2024: Key refresh mechanisms researched and deployed: proactive secret sharing (PSS) enables periodic share rotation without reconstructing full key, but coordination overhead (4-8 protocol rounds × multiple parties) limited deployment to scheduled maintenance windows rather than rapid incident response [Guide: Stackup, 2025]. 2023-2024: Advanced PSS protocols explored: "Offline Proactive Refresh" by Silence Laboratories enables share rotation without all parties simultaneously online, reducing coordination latency by allowing asynchronous participation [Research: Silence Laboratories, 2024]. 2024: Cloud-native MPC deployments adopted advanced monitoring (AWS GuardDuty, Azure Sentinel, GCP Security Command Center) providing automated threat detection, but MPC-specific indicators of compromise (IOCs) remain underdeveloped [implied from cloud security tooling]. Key lesson: Share refresh protocol runtime and coordination overhead are primary bottlenecks; organizations struggle to rotate shares within <4-8h window needed to preempt threshold compromise. Industry lacks standardized MPC incident response runbooks; each provider develops procedures independently, often discovering gaps during actual incidents. Regulatory framework challenges: GDPR 72h notification deadline conflicts with forensic uncertainty about exposure scope, forcing organizations to balance "notify early with uncertainty" vs "delay for accuracy".
   
   - **Known facts, assumptions, and uncertainties**: 
     - **Facts**: MPC threshold property requires k-of-n shares for signing [Guide: Stackup, 2025]; Partial share exposure creates future risk if additional shares compromised before rotation [implied from threat model]; $2.2B crypto theft in 2024 with compromised accounts as major vector [Report: Halborn, 2024]; Proactive secret sharing (PSS) enables share refresh without reconstructing full key [Guide: Stackup, 2025; Research: Silence Laboratories, 2024]; GDPR requires breach notification within 72 hours of awareness [Guide: ICO, 2024]; SOC 2 requires defined incident reporting procedures [implied from certification requirements]; Key refresh requires multi-party coordination (4-8 protocol rounds similar to key generation) [Guide: Stackup, 2025].
     - **Assumptions**: Compromise detection currently hours to days (inferred from limited MPC-specific monitoring and similarity to general infrastructure breach detection timelines); Share rotation currently requires 6-24+ hours coordination (based on multi-party protocol complexity and human response time); 50+ institutional custody providers globally managing est. $50B+ assets (market sizing from major players); $400K-$800K budget (2-3 security ops × 6 months × $150K annual + monitoring infrastructure $100K-$200K + forensics tools $50K-$100K + training/exercises $50K); Incident frequency 1-5 per large provider per year (extrapolated from general infrastructure breach statistics applied to MPC node count); Target detection <1h, containment <1h, rotation <4-8h based on regulatory timelines and operational requirements; 24/7 on-call requires minimum 3-5 engineers for sustainable rotation (avoiding burnout); Share refresh protocol runtime 2-8 hours (based on multi-round communication with human coordination overhead); Post-incident forensics consumes 40-200 hours over 1-4 weeks (typical for complex infrastructure incidents).
     - **Uncertainties**: Actual MPC node compromise frequency unknown (no public statistics, incident disclosure limited); Detection feasibility unclear (can monitoring systems reliably detect memory exfiltration or subtle attacker lateral movement without high false positives?); Rotation speed ceiling unknown (what is minimum achievable share refresh time with optimal automation? 2h? 4h? fundamental protocol constraints may prevent <2h target); Service availability during rotation unclear (can circuit-breaker logic accurately isolate affected assets without administrator expertise?); Regulatory interpretation of "72 hours from awareness" TBD (when does awareness begin—first suspicious log entry? confirmed compromise? completed forensics?); Client tolerance for incident notifications unknown (frequent notifications create alarm fatigue, but delayed notifications breach trust—what is acceptable frequency?); Forensic evidence preservation requirements unclear (what level of detail required for regulatory filings vs client notifications vs internal post-mortems?); Refresh protocol security properties TBD (do all PSS variants maintain equivalent security to initial key generation, or do some introduce new attack surfaces?); Multi-party coordination reliability unknown (how often will external parties be unavailable during incidents due to network outages, timezone delays, or operational constraints?).

---

## Glossary

- **Circuit breaker**: Software pattern automatically suspending operations when failure detected; in MPC incident response, selectively pauses signing for affected assets while allowing unaffected flows.
- **Containment**: Incident response phase isolating compromised systems to prevent attacker lateral movement or additional damage; for MPC, includes network segmentation and access revocation.
- **EDR (Endpoint Detection and Response)**: Security technology monitoring endpoint devices (servers, workstations) for malicious activity, enabling rapid threat detection and forensic investigation.
- **Exfiltration**: Unauthorized data transfer from compromised system; in MPC context, attacker copying key share from memory or disk to external location.
- **Forensics**: Investigation of security incident to determine compromise scope, attack timeline, root cause, and evidence for legal/regulatory proceedings.
- **GDPR (General Data Protection Regulation)**: EU regulation requiring breach notification to authorities within 72 hours of awareness; applies if personal data potentially exposed.
- **IDS/IPS (Intrusion Detection/Prevention System)**: Network security technology monitoring traffic for malicious patterns, alerting (IDS) or blocking (IPS) suspicious activity.
- **IOC (Indicator of Compromise)**: Observable artifact indicating potential security incident; examples: suspicious process, network connection, file modification.
- **Lateral movement**: Attacker technique moving from initially compromised system to additional systems within network; major risk for collecting threshold key shares.
- **Proactive Secret Sharing (PSS)**: Cryptographic protocol enabling periodic refresh of key shares without reconstructing full private key; invalidates old shares while maintaining signing capability.
- **RTO (Recovery Time Objective)**: Maximum acceptable time to restore operations after incident; for MPC wallets, balance between rapid restoration and thorough forensics.
- **Runbook**: Documented procedure for operational task (incident response, service recovery); enables execution by on-call engineers without specialized expertise.
- **Share refresh/rotation**: Process of generating new key shares cryptographically derived from old shares without materializing full private key; invalidates old shares against future compromise.
- **SIEM (Security Information and Event Management)**: Platform aggregating and analyzing security logs from multiple sources, enabling centralized monitoring and threat detection.
- **SOC 2 (Service Organization Control 2)**: Security certification framework requiring defined incident management procedures, timely notification, and post-incident review; typically requires notification within 24-72h depending on severity.
- **Tabletop exercise**: Simulated incident scenario where team discusses response procedures without executing actions; validates runbooks and identifies gaps with minimal risk.
- **Threshold property**: MPC security guarantee requiring k parties out of n to collaborate for signing; provides resilience against <k compromised parties.

---

## Reference

### Technical Guides and Research
- [Guide: Stackup, 2025] - "MPC Wallets: A Complete Technical Guide (2025)" (https://www.stackup.fi/resources/mpc-wallets-a-complete-technical-guide). MPC fundamentals, threshold signatures, key refresh mechanisms, proactive secret sharing protocols.
- [Research: Silence Laboratories, 2024] - "Offline Proactive Refresh: Strengthening Threshold Signature Wallets" (https://silencelaboratories.com/blog-posts/offline-proactive-refresh-strengthening-threshold-signature-wallets). Advanced key refresh protocols enabling asynchronous coordination, reducing rotation latency.

### Security Threat Landscape
- [Report: Halborn, 2024] - "2024 Blockchain Security in Review: Key Lessons Learned" (https://www.halborn.com/blog/post/2024-blockchain-security-in-review-key-lessons-learned). Cryptocurrency security incidents, compromise vectors, $2.2B theft analysis, multi-sig and MPC security recommendations.

### Regulatory and Compliance
- [Guide: ICO, 2024] - "72 hours - how to respond to a personal data breach" (https://ico.org.uk/for-organisations/advice-for-small-organisations/personal-data-breaches/72-hours-how-to-respond-to-a-personal-data-breach). GDPR breach notification requirements, 72-hour timeline, scope assessment guidance, authority notification procedures.
- [Guide: ICO, 2024] - "Personal data breaches: a guide" (https://ico.org.uk/for-organisations/report-a-breach/personal-data-breach/personal-data-breaches-a-guide). Comprehensive GDPR breach response framework, affected individual notification, documentation requirements.

### Supplementary Sources
- [Source: Supplementary] - Problem extraction document GPT5.1HighReasoning.md (2025-11-28). Incident response timelines, share rotation complexity, forensics challenges, notification requirements, operational coordination constraints (used as inspiration, cross-validated with authoritative sources).
