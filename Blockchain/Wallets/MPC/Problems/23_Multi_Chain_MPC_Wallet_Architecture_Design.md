# Multi-Chain MPC Wallet Architecture Design for Production Scale

**Last Updated**: 2025-11-29  
**Status**: Draft  
**Owner**: Platform Architecture Team

## Problem Statement

1. **[CRITICAL]** Q: Institutional MPC wallet providers securing high-value assets across Bitcoin, Ethereum, and Solana face critical architectural challenges balancing single-point-of-compromise elimination with sub-2-second signing latency while enabling rapid multi-chain expansion without creating unauditable cryptographic-core complexity. Formulate a structured problem statement using the following [Input] fields.
   
   A:
   - **Brief description of the problem to be analyzed**: 
     Organizations deploying production-grade MPC wallets for institutional custody ($50M-$500M assets under management) must architect systems eliminating single points of key compromise while maintaining p95 signing latency <2s for mobile/API clients and enabling new blockchain integrations in weeks rather than months. Current monolithic designs tightly couple MPC protocols, chain-specific transaction logic, and key management, creating audit barriers, slowing chain additions (requiring 3-6 months per chain), and introducing latency bottlenecks. This affects 50+ institutional custody providers, cryptocurrency exchanges managing 100M+ users, and enterprise treasury operations requiring SOC 2 compliance and multi-blockchain support.
   
   - **Background and current situation**: 
     Institutional custody requires MPC wallet support for multiple blockchain protocols: Bitcoin (UTXO model), Ethereum/EVM chains (account model, smart contracts), Solana (account model, parallel execution) [Blog: AWS, 2024]. Current architectures often embed MPC signing logic directly into blockchain-specific services, creating tight coupling between cryptographic core and transaction construction [Blog: AAUBlog, 2024]. Monolithic designs result in: (1) Security audit difficulty: reviewers must understand both MPC cryptography and chain-specific logic simultaneously; (2) Slow chain integration: adding Solana or new EVM chain requires 3-6 months engineering effort modifying MPC core; (3) Latency challenges: p95 signing latency 3-5s due to inefficient coordinator communication patterns [Source: Supplementary]. Microservices and hexagonal architecture patterns offer separation of concerns, isolating MPC core from chain adapters, but require careful design to avoid introducing new single points of failure [Blog: AAUBlog, 2024]. Institutional clients demand: SOC 2 Type II certification requiring clear security boundaries, 99.9% uptime (≤8.7h downtime/year), support for ≥3 major chains, and signing latency <2s for competitive DeFi/trading operations [Blog: AWS, 2024]. Teams typically consist of 5-8 engineers with 6-12 month delivery windows, using Rust/Go microservices and Kafka-like message brokers for inter-service communication [Source: Supplementary].
   
   - **Goals and success criteria**: 
     Architecture clarity: Achieve clean separation between MPC core, coordinator, and transaction services → ≥3 independent audit scopes (current: monolithic single scope) by Q2 2025. Security guarantees: Demonstrate zero single-server key reconstruction capability → pass penetration testing and formal verification showing n-1 server compromises insufficient (current: unclear blast radius in monolithic designs). Signing latency: p95 end-to-end signing <2s (min) / <1.5s (target) / <1s (ideal) for mobile and API clients under normal network conditions (current: 3-5s). Failure rates: Transaction signing failures <2% (min) / <1% (target) / <0.5% (ideal) under normal operation (current: est. 3-5%). Chain integration efficiency: New ECDSA/EdDSA chain integration <80 engineering hours (min) / <40 hours (target) / <20 hours (ideal) per chain (current: 480-960 hours over 3-6 months). Audit success: Zero critical security findings in SOC 2 Type II audits by Q4 2025 (current: architectural complexity creates audit delays).
   
   - **Key constraints and resources**: 
     Timeline: Q1 2025 - Q3 2025 (6-9 months architecture design + implementation + migration); Budget: $400K-$800K for 5-8 engineers over 6-9 months; Team: 2-3 security/cryptography engineers (MPC core), 2-3 backend engineers (coordinator/services), 1-2 blockchain specialists (chain adapters), 0.5-1 architect; Technology stack: Rust or Go for MPC core (type safety, memory safety), Kafka or RabbitMQ for async messaging between services, commodity cloud infrastructure (AWS, GCP, Azure across ≥2 regions); Compatibility: Must support existing threshold protocols (CGGMP21, GG20, FROST), backward compatible with deployed key shares (no forced migration); Compliance: SOC 2 Type II requirements (audit trails, access controls, security boundaries), separation of duties for institutional clients; Performance: Cannot add >500ms latency overhead from architectural layering; Operational: Must maintain 99.9% uptime during gradual migration from monolithic to modular architecture.
   
   - **Stakeholders and roles**: 
     Security/Cryptography Engineers (2-3 per organization, need clear MPC core boundaries for audit/verification, constraint: cannot compromise threshold security properties for performance); Backend/SRE Teams (3-5 engineers, need operational visibility and incident response procedures, constraint: 99.9% uptime requirement during migration); Product/Custody Operations (2-3 managers, need multi-chain support roadmap and SLA commitments to clients, constraint: competitive pressure from other custody providers); Compliance Officers (1-2 per organization, need SOC 2 control separation and audit trail clarity, constraint: must demonstrate security boundaries to auditors); Institutional Clients (50+ custody customers managing $10M-$500M each, need assurance on blast radius and recovery procedures, constraint: cannot tolerate multi-day outages during architecture changes); Blockchain Integration Engineers (2-3 per chain, need clear adapter interfaces and documentation, constraint: limited MPC expertise, need isolation from cryptographic complexity).
   
   - **Time scale and impact scope**: 
     Timeline: Q1 2025 - Q3 2025 (6-9 months design + implementation); Q3 2025 - Q1 2026 (6 months gradual migration from legacy to new architecture); Systems: MPC key generation and signing core, distributed coordinator service, chain-specific transaction construction adapters (Bitcoin, Ethereum, Solana, future chains), message broker infrastructure, monitoring and observability stack; Scale: 50+ institutional custody providers, est. $50B+ assets under management globally, 100M+ end users depending on custody services, thousands of daily active addresses per major client; Architecture Impact: Migration from monolithic single-service to 5-8 microservices with clear interfaces, affects all signing flows across all chains; Risk: Flawed architecture decisions persist 3-5 years (typical system lifetime), making protocol upgrades or jurisdictional compliance changes prohibitively expensive; Adoption: Architectural clarity enables faster enterprise customer onboarding (reducing sales cycle from 9-12 months to 6-9 months by demonstrating clear security model).
   
   - **Historical attempts and existing solutions (if any)**: 
     2018-2021: First-generation MPC wallets (ZenGo, Coinbase WaaS) deployed monolithic architectures embedding MPC logic in single services, achieving initial product launch but accumulating technical debt as chain support expanded [implied from industry evolution]. 2021-2023: Some providers experimented with protocol-first separation (MPC core as library), but chain-specific services still tightly coupled to cryptographic implementation, making audits and testing difficult [Source: Supplementary]. 2023-2024: Cloud-native deployments adopted Kafka-style message brokers for async communication, improving fault tolerance but not addressing architectural coupling between MPC and chain logic [Blog: AAUBlog, 2024]. 2024: Hexagonal architecture patterns explored for digital wallets, emphasizing ports-and-adapters for blockchain integration, but MPC-specific implementations remain limited [Blog: AAUBlog, 2024]. AWS published reference architecture for MPC wallets using Nitro Enclaves, demonstrating microservices separation but focused on infrastructure-level isolation rather than application architecture [Blog: AWS, 2024]. Key lesson: Reference architectures exist (hexagonal, ports-and-adapters, message-broker-based clusters) but MPC-specific implementations with measured latency/complexity trade-offs remain scarce, forcing each provider to rediscover architectural patterns independently.
   
   - **Known facts, assumptions, and uncertainties**: 
     - **Facts**: MPC wallets eliminate single private key by distributing shares with k-of-n threshold [Guide: Coinbase, 2024]; Current monolithic architectures couple MPC core with chain-specific logic [Source: Supplementary]; Institutional custody requires SOC 2 Type II, 99.9% uptime, multi-chain support [Blog: AWS, 2024]; Hexagonal and microservices architectures offer separation of concerns [Blog: AAUBlog, 2024]; AWS Nitro Enclaves used for infrastructure-level MPC party isolation [Blog: AWS, 2024]; Typical institutional MPC teams: 5-8 engineers with 6-12 month delivery windows [Source: Supplementary].
     - **Assumptions**: p95 signing latency 3-5s in current monolithic designs (inferred from multi-round protocol communication and observed performance); New chain integration requires 480-960 hours over 3-6 months in monolithic architectures (based on typical complexity of integrating Bitcoin/Ethereum/Solana transaction construction with MPC signing); 50+ institutional custody providers globally managing est. $50B+ assets (market sizing from Coinbase institutional custody $130B, Fireblocks, BitGo, other major players); $400K-$800K budget (5-8 engineers × 6-9 months × $120K-$180K annual salary equivalent); Failure rate est. 3-5% in current systems (inferred from network conditions and multi-party coordination challenges); Architecture migration feasible over 6-12 months with gradual rollout avoiding service disruption.
     - **Uncertainties**: Optimal service boundary granularity unknown (should transaction construction be per-chain service or unified with chain adapters?); Performance overhead from architectural layering unclear (does microservices separation add 100ms? 500ms? to end-to-end latency?); Message broker reliability impact TBD (can Kafka/RabbitMQ maintain <50ms p95 latency under load?); Migration strategy risk unclear (can gradual rollout avoid major outages or does architecture change require cutover?); Auditor acceptance of architectural separation unknown (will SOC 2 auditors accept microservices boundaries as sufficient control separation?); Backward compatibility feasibility unclear (can existing key shares work with new architecture without complex migration ceremonies?); Future chain requirements unknown (will post-quantum or exotic signature schemes fit architectural model designed for ECDSA/EdDSA?).

---

## Glossary

- **Adapter/Port (Hexagonal Architecture)**: Design pattern isolating core business logic (MPC signing) from external systems (blockchain transaction construction) via defined interfaces, enabling independent evolution and testing.
- **Assets Under Management (AUM)**: Total value of digital assets held in custody; institutional MPC wallets typically serve clients with $10M-$500M AUM each.
- **Blast radius**: Scope of systems affected by security compromise; MPC architecture aims to ensure single-server compromise has zero blast radius (cannot extract full private key).
- **CGGMP21**: Modern threshold ECDSA protocol requiring 4 signing rounds, providing security proofs and performance balance suitable for production deployments.
- **Commodity cloud infrastructure**: Standard cloud computing resources (AWS EC2, GCP Compute, Azure VMs) without specialized hardware, enabling cost-effective multi-region deployment.
- **FROST (Flexible Round-Optimized Schnorr Threshold)**: Efficient threshold signature protocol for EdDSA (ed25519), requiring 2 signing rounds, suitable for Solana and similar chains.
- **GG20**: Threshold ECDSA protocol (Gennaro & Goldfeder, 2020) requiring 6 signing rounds, widely deployed but superseded by CGGMP21 for new implementations.
- **Hexagonal Architecture (Ports and Adapters)**: Software design pattern separating core domain logic from external dependencies through explicit interfaces (ports) and implementations (adapters).
- **Message broker**: Middleware system (Kafka, RabbitMQ) enabling asynchronous communication between microservices, providing fault tolerance and decoupling.
- **Microservices architecture**: Design approach decomposing application into small, independent services communicating via APIs/messages, enabling separate deployment and scaling.
- **Monolithic architecture**: Software design where all functionality exists in single deployable unit, creating tight coupling and complicating maintenance as complexity grows.
- **p95 latency**: 95th percentile response time; 95% of requests complete faster than this threshold, representing typical user experience excluding worst outliers.
- **SOC 2 Type II**: Security certification for service organizations covering security controls over ≥6 month period; required for institutional custody providers.
- **Threshold signature**: Cryptographic scheme requiring k parties out of n to cooperate for signing, preventing single point of compromise; MPC wallets typically use 2-of-3, 3-of-5, or similar thresholds.
- **Transaction construction**: Process of building blockchain-specific transaction formats (UTXO inputs/outputs for Bitcoin, nonce/gas for Ethereum, recent blockhash for Solana) before cryptographic signing.

---

## Reference

### Web Sources - Cloud & Architecture
- [Blog: AWS, 2024] - "Build secure multi-party computation (MPC) wallets using AWS Nitro Enclaves" (https://aws.amazon.com/blogs/web3/build-secure-multi-party-computation-mpc-wallets-using-aws-nitro-enclaves). MPC wallet deployment patterns, institutional requirements, infrastructure isolation approaches.
- [Blog: AAUBlog, 2024] - "APIs and Microservices: How to Create Modular Digital Wallet Architectures for Future-Ready Solutions" (https://aaublog.com/apis-and-microservices-how-to-create-modular-digital-wallet-architectures-for-future-ready-solutions). Microservices architecture for digital wallets, modularity benefits, scalability patterns.

### Educational Resources
- [Guide: Coinbase, 2024] - "What is a Multi-Party Computation (MPC) wallet?" (https://www.coinbase.com/learn/wallet/what-is-a-multi-party-computation-mpc-wallet). MPC fundamentals, threshold signatures, key distribution architecture.

### Supplementary Sources
- [Source: Supplementary] - Problem extraction document GPT5.1HighReasoning.md (2025-11-28). Production deployment requirements, team constraints, latency targets, institutional client needs (used as inspiration, cross-validated with authoritative sources).
