# Session Hijacking and Connection State Attacks in MPC Wallet Protocols

**Last Updated**: 2025-11-29  
**Status**: Draft  
**Owner**: Security & Protocol Team

## Problem Statement

1. **[Important]** Q: MPC wallet threshold signature protocols require multi-round interactive sessions between distributed parties (2-5 rounds typical), creating session management vulnerabilities where connection hijacking, state desynchronization, replay attacks, and malicious session manipulation can compromise signing security, particularly affecting browser-based wallets using WebSocket connections and mobile wallets on unreliable networks serving 100M+ users with $50B+ assets. Formulate a structured problem statement using the following [Input] fields.
   
   A:
   - **Brief description of the problem to be analyzed**: 
     MPC threshold signatures (ECDSA, EdDSA, Schnorr) execute through multi-round protocols where n parties (typically 2-5) exchange cryptographic messages in 2-7 interactive rounds depending on protocol (Lindell17 2-of-2: 6 rounds, GG18/20 n-of-n: 4-5 rounds, CGGMP20: 7 rounds) to jointly compute signature without reconstructing private key [Technical: MPC Protocol Rounds; Guide: Stackup MPC]. Each round requires: maintaining session state (partial signatures, commitments, zero-knowledge proofs), secure transport (TLS/WSS preventing eavesdropping), authenticated participants (preventing impersonation), synchronized round progression (all parties complete round i before anyone starts round i+1), timeout handling (detecting unresponsive parties), failure recovery (restarting on network partition or computation errors) [Technical: Session Management Requirements]. Vulnerabilities arise across multiple attack surfaces: **Session hijacking**—attacker intercepts session tokens (cookies, JWTs, WebSocket auth) through XSS, MITM, or token theft, impersonates legitimate party, injects malicious messages into signing protocol, causes signature malleability or denial-of-service [Attack: Session Hijacking]. **State desynchronization**—network latency, packet loss, or malicious manipulation causes parties to diverge in protocol state (party A believes round 3 complete, party B still in round 2), subsequent messages misinterpreted, signing fails or produces invalid signature, requires expensive restart from round 1 [Vulnerability: State Desync]. **Replay attacks**—attacker captures legitimate protocol messages from previous signing session, replays them in current session, exploits insufficient message uniqueness (missing nonces, session IDs, timestamps), causes protocol confusion or enables key extraction through repeated signing with identical randomness [Attack: Replay]. **Connection disruption**—attacker performs DoS against subset of parties (3 of 5 parties), prevents threshold achievement (need 3 of 5 but only 2 reachable), signing deadlock until connectivity restored, particularly problematic for time-sensitive transactions (DeFi arbitrage, liquidation prevention) [Attack: Selective DoS]. **Malicious coordination server**—centralized MPC coordination infrastructure (Fireblocks, BitGo backend servers) becomes single point of failure, compromised server can: selectively drop messages causing signing failures, reorder messages inducing state confusion, log all protocol messages enabling offline cryptanalysis, inject malicious protocol messages if authentication weak [Vulnerability: Coordinator Compromise]. Financial impact: Direct losses from successful session attacks not well-publicized (detection difficult, may be attributed to other causes), but $1.4B Bybit hack 2024 involved compromised transaction signing (unclear if session attack component), indirect losses from signing failures and UX degradation (failed transactions costing gas, users abandoning wallets due to reliability issues) estimated $10M-$50M annually across ecosystem [Impact: Failed Signing Costs; Incident: Bybit 2024]. Current mitigation inconsistent: ~40% of MPC wallet implementations use secure session management (nonce-based message authentication, session ID binding, replay protection), ~30% implement robust failure recovery (automatic session restart, state checkpoint-restore), <20% deploy decentralized coordination (no single coordinator SPOF, peer-to-peer protocol execution), creating heterogeneous security landscape where users cannot evaluate session security properties [Market: Session Security Adoption].
   
   - **Background and current situation**: 
     MPC threshold signature protocols inherently multi-round interactive: **Lindell17 (2-of-2 ECDSA)**—6 rounds: (1) Paillier key generation + ZK proof, (2) encrypted ECDSA key generation, (3-4) signing parameter exchange, (5) partial signature computation, (6) signature combination + verification. Each round requires both parties online, exchanging ~10-50 KB data total [Protocol: Lindell17]. **GG18/20 (n-of-n ECDSA)**—4-5 rounds: (1) distributed key generation (DKG) with commitments, (2) key share distribution, (3) partial signature computation, (4) signature combination. DKG setup one-time (reusable for multiple signings), but signing itself 3 rounds, ~50-200 KB data depending on n [Protocol: GG18/20]. **CGGMP20 (threshold t-of-n ECDSA)**—7 rounds: (1) presigning parameter commitment, (2-4) zero-knowledge proof exchanges, (5) partial signature computation, (6) signature shares combination, (7) final signature verification. Most secure protocol but highest round complexity and bandwidth (100-500 KB) [Protocol: CGGMP20]. **Session state requirements**: Each party maintains ephemeral state during protocol: session ID (unique identifier for this signing request), participant list (which parties involved, their public keys), round number (current protocol step 1-7), accumulated messages (previous rounds' data needed for verification), commitments (cryptographic bindings preventing cheating), partial results (intermediate computations), timestamps (detecting stale messages), nonces (preventing replay) [State: Session Context]. State must persist across rounds (spanning seconds to minutes depending on network latency), survive network disconnections (reconnection resumes rather than restarts), remain consistent across parties (all agree on current state) [Challenge: State Persistence]. **Transport layer**: Browser-based MPC wallets (Web3Auth, Magic) use WebSocket (WSS) connections for bi-directional real-time messaging, mobile wallets (ZenGo) use HTTPS long-polling or WSS, institutional custody (Fireblocks, BitGo) uses dedicated TLS connections or VPN tunnels [Transport: Connection Types]. WebSocket security depends on: connection authentication (JWT tokens, session cookies included in WSS upgrade request), message authentication (HMAC or digital signature on each message preventing tampering), session binding (token tied to specific signing session, not reusable) [Security: WebSocket Auth]. Weaknesses: XSS vulnerability in wallet UI can steal WebSocket tokens from JavaScript context, MITM on initial HTTPS connection can downgrade to non-WSS, token reuse across sessions enables replay if not properly scoped [Vulnerability: Token Security]. **Coordination architectures**: **Centralized coordinator** (most common ~60% implementations)—dedicated backend server orchestrates protocol rounds, receives messages from all parties, validates correctness, broadcasts to others, maintains authoritative session state. Benefits: simplifies client implementation, provides reliable message ordering, enables features like partial signing (some parties approve, others still pending). Risks: coordinator compromise or DoS creates single point of failure, coordinator can log all messages enabling offline cryptanalysis, requires trust in coordinator operator [Architecture: Centralized]. **Peer-to-peer coordination** (~20% implementations)—parties communicate directly without intermediary, use gossip protocol or direct connections, collectively maintain distributed session state. Benefits: eliminates single point of failure, no coordinator to compromise. Challenges: network complexity (n² connections for n parties), state synchronization harder (Byzantine agreement required), NAT traversal difficult (peers behind firewalls need relay) [Architecture: P2P]. **Hybrid coordination** (~20% implementations)—coordinator for message routing but parties perform mutual authentication, coordinator cannot read message contents (encrypted payloads), coordinator cannot forge messages (digital signatures). Balance of convenience and security [Architecture: Hybrid]. **Attack scenarios**: **Session hijacking via XSS**—attacker injects malicious JavaScript into wallet UI (through compromised dependency, supply chain attack, or stored XSS in dApp), steals WebSocket authentication token from browser memory, opens parallel connection to MPC coordinator impersonating legitimate party, injects malicious protocol messages (wrong partial signature, invalid zero-knowledge proof), causes signing failure or potentially enables key extraction if combined with other vulnerabilities [Attack: XSS Session Theft]. **Man-in-the-middle downgrade**—attacker intercepts initial HTTPS connection establishing WebSocket, downgrades from WSS (encrypted) to WS (plaintext) if wallet doesn't enforce HSTS, eavesdrops on all protocol messages, performs offline cryptanalysis attempting key extraction, or actively injects messages modifying transaction contents [Attack: MITM Downgrade]. **Replay attack**—attacker captures signing session messages for transaction A (e.g., "Send 1 ETH to Bob"), later replays identical messages to sign transaction B with same parameters, succeeds if: protocol doesn't include transaction hash in signing messages (just signs nonce), nonces reused across sessions, session IDs not properly validated [Attack: Replay]. Academic research demonstrated practical replay attacks against naive threshold signature implementations missing message authentication codes (MACs) or nonce binding [Research: Threshold Signature Replay]. **State desynchronization via selective dropping**—attacker with MITM position drops messages to subset of parties, party A receives all round 3 messages and advances to round 4, party B missing one message remains in round 3, B's round 4 message interpreted by A as malformed, protocol aborts, requires restart from round 1 wasting computation (seconds to minutes) and potential gas costs if blockchain transaction initiated [Attack: Message Dropping]. **Connection disruption DoS**—attacker floods network connections to threshold minority (2 of 5 parties), saturates bandwidth preventing protocol messages from reaching them, remaining 3 parties cannot achieve threshold without the 2, signing deadlock, particularly severe for time-sensitive operations (DeFi liquidation protection requires signing within seconds, disruption causes position liquidation) [Attack: Threshold DoS]. **Coordinator compromise**—if centralized MPC backend hacked (Bybit 2024 suggests transaction signing infrastructure compromised), attacker gains: ability to log all signing session messages (offline cryptanalysis attempting key extraction over time), ability to selectively fail signings (deny service to specific users/transactions), ability to inject malicious messages if authentication weak (modify transaction recipients or amounts), complete visibility into user transaction patterns (privacy violation) [Attack: Coordinator Breach].
   
   - **Goals and success criteria**: 
     Session authentication: Achieve ≥95% (min) / ≥98% (target) / ≥99.5% (ideal) of MPC wallet implementations using cryptographically bound session tokens (JWT with session ID + nonce + expiry, non-reusable across sessions) by Q4 2026 (current: ~40%). Replay protection: Implement message-level nonces or sequence numbers in ≥90% (min) / ≥95% (target) / ≥99% (ideal) of protocol messages preventing replay attacks by Q4 2026 (current: ~60% academic protocols have replay protection, production implementations less clear). State synchronization: Achieve ≥95% (min) / ≥98% (target) / ≥99.5% (ideal) successful session completion rate under 10% packet loss and 500ms latency through checkpoint-restore and automatic resynchronization by Q4 2027 (current: ~70-80% completion rate under adverse network, anecdotal). Connection security: Enforce WSS (WebSocket Secure) with HSTS for ≥99% (min) / ≥99.5% (target) / ≥99.9% (ideal) of browser-based MPC sessions preventing downgrade attacks by Q4 2026 (current: ~80-90% use WSS but HSTS adoption unclear). Coordinator decentralization: Achieve ≥30% (min) / ≥50% (target) / ≥70% (ideal) of MPC wallet implementations using peer-to-peer or decentralized coordination eliminating single coordinator SPOF by Q4 2027 (current: ~20% P2P or decentralized). Failure recovery: Implement automatic session restart with state checkpointing completing recovery within ≤10s (max) / ≤5s (target) / ≤2s (ideal) for ≥90% of failed sessions by Q4 2026 (current: many implementations require manual user retry). DoS resistance: Achieve ≤0.1% (max) / ≤0.01% (target) / ≤0.001% (ideal) signing failure rate under selective DoS attacks (targeting 40% of threshold parties) through redundant connectivity and adaptive routing by Q4 2027 (current: DoS resilience largely untested). Message authentication: Implement per-message HMAC or digital signature in ≥95% (min) / ≥98% (target) / ≥99.5% (ideal) of protocol implementations preventing message tampering and injection by Q4 2026 (current: ~50-70% estimated). Session monitoring: Deploy real-time anomaly detection identifying session hijacking attempts (unusual message patterns, multiple concurrent sessions, replay indicators) with ≤100ms (max) / ≤50ms (target) / ≤10ms (ideal) detection latency and ≥95% true positive rate by Q4 2027 (current: <10% implementations have session monitoring). Transport security: Achieve zero successful MITM downgrade attacks across major MPC wallet providers Q1 2026 - Q4 2027 through certificate pinning and HSTS enforcement (current: no public incidents but testing limited). Protocol standardization: Establish session management best practices specification (NIST, IETF, or MPC Alliance standard) adopted by ≥60% (min) / ≥80% (target) / ≥90% (ideal) of MPC wallet providers by Q4 2027 defining session ID format, message authentication, replay protection, state synchronization, failure recovery (current: no standard exists).
   
   - **Key constraints and resources**: 
     Timeline: Q1 2026 - Q4 2027 (24 months for session security upgrades, protocol standardization, decentralized coordination development, security audits, industry adoption); Budget: $200K-$800K per major provider for session security improvements (secure session management implementation $50K-$150K for JWT infrastructure + message authentication, decentralized coordination refactoring $100K-$300K for P2P protocol or hybrid architecture, failure recovery mechanisms $30K-$100K for checkpoint-restore logic, session monitoring $50K-$150K for anomaly detection + alerting, security audits $50K-$200K for session attack penetration testing); Team: Per provider: 2-3 protocol engineers (session management, state synchronization, failure recovery), 1-2 backend engineers (coordinator infrastructure, WebSocket management, database for session state), 1-2 security engineers (session attack simulation, monitoring, incident response), 0.5-1 cryptography consultant (replay protection, nonce management, message authentication schemes); Technology: Secure session tokens (JWT with short expiry 5-15min + refresh tokens, session ID + nonce binding, cryptographic signature), message authentication (HMAC-SHA256 or Ed25519 signatures per message), WebSocket security (certificate pinning, HSTS enforcement, WSS-only mode, connection rate limiting), state persistence (Redis or database with checkpoint snapshots every round, transaction log for replay), failure recovery (exponential backoff retry, automatic session restart from last checkpoint, partial signature caching), P2P coordination (libp2p, WebRTC data channels for browser, NAT traversal STUN/TURN servers), monitoring (Prometheus metrics for session success rate, Grafana dashboards, anomaly detection ML models flagging unusual patterns); Performance tradeoffs: Message-level authentication adds 10-50ms latency per round (HMAC computation + verification, digital signature 50-200ms if using ECDSA), checkpoint-restore adds storage overhead (1-10 MB per session depending on protocol), P2P coordination increases bandwidth (n² message complexity vs. n for centralized), retry mechanisms increase total signing time (5-10s typical signing becomes 10-20s if first attempt fails and retry triggered) [Constraint: Performance Impact]; Network heterogeneity: Mobile wallets on cellular networks experience higher packet loss (5-15%) and variable latency (200ms-2s) compared to institutional fiber connections (<1% loss, <50ms latency), browser wallets behind corporate firewalls may block WebSocket, P2P connections NAT-traversed requiring relay servers (TURN) adding cost $0.001-0.01 per session [Constraint: Network Variability]; Backward compatibility: Upgrading session management requires coordinated deployment across all parties (can't have party A using new session protocol communicating with party B using old), phased migration challenging if users control multiple parties (device + server + cloud), breaking protocol changes risk stranding users on old versions unable to sign [Constraint: Migration Complexity]; Coordinator economics: Decentralized coordination eliminates centralized server costs ($10K-$100K annually for high-availability infrastructure) but increases client device battery/bandwidth consumption (peer-to-peer gossiping more expensive than single server connection), may reduce mobile wallet adoption if battery drain significant [Constraint: Decentralization Cost]; Security-usability tension: Shorter session token expiry (5min) improves security but frustrates users if signing takes longer (multi-round protocol + user approval UI may exceed 5min), aggressive timeout and retry (abort after 30s) improves DoS resistance but causes false failures on slow networks, mandatory session monitoring adds infrastructure cost $5K-$20K annually per provider [Constraint: Security-UX Balance].
   
   - **Stakeholders and roles**: 
     MPC Wallet Users (100M+ across all implementations, need reliable signing under variable network conditions with transparent error messages and automatic retry, constraint: unaware of session security and cannot evaluate implementations); MPC Wallet Providers (Fireblocks, BitGo, Coinbase WaaS, ZenGo, Web3Auth, Magic serving users and managing signing infrastructure, need to balance session security with performance and cost, constraint: $200K-$800K per-provider upgrade costs and backward compatibility challenges); Browser Wallet Developers (MetaMask MPC features, Brave Wallet exploring MPC, need WebSocket security against XSS and MITM, constraint: browser security model limitations and JavaScript execution environment risks); Mobile Wallet Developers (ZenGo, Argent, Trust Wallet exploring MPC, need cellular network resilience and battery-efficient protocols, constraint: iOS/Android platform restrictions and push notification latency); Institutional Custody Providers (Fireblocks, BitGo, Anchorage Digital managing high-value accounts $100M+ per institution, need five-nines reliability and audit-grade session logging, constraint: regulatory requirements for session integrity and cannot tolerate signing failures); DeFi Users (executing time-sensitive transactions like liquidation protection, arbitrage, need <5s signing latency including session setup, constraint: failed signings result in lost opportunities or liquidated positions costing $1K-$100K per incident); Security Researchers (analyzing session attack vectors, testing hijacking and replay attacks, need access to MPC implementations for responsible disclosure, constraint: coordinated vulnerability disclosure timelines and vendor responsiveness varies); Cloud Infrastructure Providers (AWS, GCP, Azure hosting MPC coordinator infrastructure, need to prevent cross-tenant attacks and provide session isolation, constraint: multi-tenant economics vs. security isolation costs 2-3x for dedicated instances); Network Security Vendors (Cloudflare, Akamai providing DDoS protection for MPC coordinators, need to distinguish legitimate signing traffic from attack patterns, constraint: MPC protocol traffic patterns unusual and may trigger false positive rate limiting); Standards Bodies (NIST, IETF, MPC Alliance, need to establish session security best practices and protocol specifications, constraint: academic rigor vs. industry implementation feasibility tension); Insurance Providers (crypto custody insurance covering operational failures, need to assess session attack risk and price policies accordingly, constraint: limited actuarial data on session attacks and unclear if "failed signing" covered vs. excluded).
   
   - **Time scale and impact scope**: 
     Timeline: Q1 2026 - Q4 2027 (24 months for session security implementation, protocol standardization, industry adoption, security audits); Systems: MPC threshold signature protocols (Lindell17, GG18/20, CGGMP20 session management), WebSocket transport layer (WSS authentication, HSTS enforcement, connection lifecycle), session coordination infrastructure (centralized coordinators, P2P gossip protocols, hybrid architectures), state persistence (Redis, PostgreSQL, checkpoint-restore logic), message authentication (HMAC, digital signatures, nonce management), failure recovery (retry logic, automatic restart, partial signature caching), monitoring and alerting (anomaly detection, session success rate tracking, security incident response); Current landscape: ~40% of MPC wallets use cryptographically secure session tokens (JWT with nonce + session ID binding), ~60% implement replay protection in protocol messages (academic protocols better than production implementations), ~20% deploy decentralized/P2P coordination (majority use centralized coordinator), ~50-70% implement per-message authentication (HMAC or signatures), <10% have real-time session monitoring for attack detection, ~80-90% browser wallets use WSS but HSTS adoption unclear, session completion rate ~70-80% under adverse network conditions (10% packet loss, 500ms latency) [Market: Session Security Landscape]; Financial exposure: 100M+ MPC wallet users globally, $50B+ assets under management, individual session hijacking attack could drain $1K-$100K+ per wallet, systematic campaign could result $10M-$100M+ losses, indirect costs from signing failures (gas fees on failed transactions, lost DeFi opportunities, user abandonment) estimated $10M-$50M annually [Financial: Session Risk]; Attack surface: Browser wallets vulnerable to XSS token theft (JavaScript supply chain attacks, malicious dApp injection), WebSocket connections susceptible to MITM if HSTS not enforced (downgrade from WSS to WS), centralized coordinators single point of failure (60% implementations), insufficient message authentication enables injection/tampering (30-50% implementations estimated), replay protection gaps allow transaction duplication (40% vulnerable), state desynchronization causes 20-30% signing failures under packet loss, DoS targeting threshold parties causes deadlock [Surface: Session Vulnerabilities]; Performance implications: Message-level authentication adds 10-50ms per round (total 50-350ms for 7-round CGGMP20), checkpoint-restore adds 1-10 MB storage per session (scaling to millions of daily sessions requires infrastructure investment), P2P coordination increases bandwidth n² (5 parties = 25x vs. centralized coordinator), retry mechanisms increase user-perceived latency (5-10s typical becomes 10-20s with failure + retry), session monitoring infrastructure adds $5K-$20K annually per provider [Performance: Overhead]; Network resilience: Mobile wallets on cellular (5-15% packet loss, 200ms-2s variable latency) need aggressive retry and state resync, institutional fiber connections (<1% loss, <50ms latency) can optimize for speed over resilience, browser wallets behind corporate firewalls may block WebSocket requiring HTTPS long-polling fallback (2-5x latency penalty), P2P connections NAT-traversed via TURN relay servers adding $0.001-0.01 per session [Network: Heterogeneity]; Regulatory implications: Financial authorities scrutinizing MPC session integrity (audit logs, tamper-evidence, non-repudiation), GDPR data residency affects session state storage (EU users require EU-hosted coordinators), cross-border signing sessions create jurisdictional ambiguity (US party + EU party signing for Asian transaction—which regulations apply?) [Regulatory: Session Compliance].
   
   - **Historical attempts and existing solutions (if any)**: 
     2017-2020: Early MPC wallet implementations (ZenGo, Fireblocks) focused on cryptographic protocol security (key extraction prevention, malicious participant resistance) with less attention to session management—assumed secure transport (TLS) sufficient, minimal replay protection, centralized coordinators for simplicity. Session attacks not prominent threat (wallet adoption low, attacker focus on exchange hacks and phishing). 2021-2022: Browser-based MPC wallets (Web3Auth, Magic) introduced new attack surface—WebSocket connections in JavaScript environment vulnerable to XSS and supply chain attacks, initial implementations used basic session tokens (cookies) without cryptographic binding, some replay attacks possible through message capture-replay. Academic research began analyzing threshold signature session security: papers demonstrated replay attacks against naive implementations missing nonces [Research: Threshold Signature Replay], cache-timing attacks on MPC coordination servers revealing partial session state [Research: MPC Cache Timing]. 2023: Fireblocks BitForge research disclosed key extraction vulnerabilities in threshold ECDSA protocols (Lindell17, GG18/20), remediation included improved session management (stronger message authentication, replay protection through nonces, state integrity checks) but primarily addressed protocol-level crypto issues [Research: BitForge 2023]. Industry began recognizing session security importance after observing signing failure rates 20-30% under poor network conditions (mobile users, developing countries), user frustration with "transaction failed, please try again" without visibility into root cause (session timeout? network disruption? coordinator failure?). 2024: Bybit $1.4B hack demonstrated compromise of transaction signing infrastructure (exact mechanism not fully disclosed, possibly involved coordinator compromise or session hijacking) [Incident: Bybit 2024], catalyzing industry attention to operational security around MPC signing. YOSO (You Only Speak Once) MPC research proposed stateless parties sending one message each never needing to speak again, addressing session management by eliminating sessions, but YOSO protocols computationally expensive and not yet practical for wallet-scale deployment [Research: YOSO MPC 2021]. Stateful group communication research ("Chat Sessions") formalized security guarantees for asynchronous settings where parties join/leave dynamically, providing theoretical foundation for secure session management but requiring further engineering for production [Research: Chat Sessions 2024]. Current state: ~40% of major MPC wallet providers implement secure session tokens with cryptographic binding and expiry, ~60% have replay protection through message nonces or sequence numbers (but testing limited, actual effectiveness unclear), ~20% deployed decentralized coordination (P2P or Byzantine consensus) eliminating centralized coordinator SPOF, <10% have real-time session monitoring detecting hijacking attempts, ~50-70% implement per-message authentication (HMAC or signatures). Remaining gaps: No industry standard for session management (each provider implements differently), limited security audits specifically targeting session attacks (most audits focus on cryptographic protocol), incomplete failure recovery (many wallets require manual user retry rather than automatic session restart), insufficient DoS resistance (selective disruption of threshold minority causes deadlock). Key lessons: Session management as important as cryptographic protocol security—perfect crypto defeated by session hijacking or replay attacks, failure recovery critical for usability under unreliable networks (mobile, developing countries), centralized coordinators convenient but create single point of failure (need migration path to decentralized), message-level authentication prevents tampering but adds latency (optimization needed), monitoring and anomaly detection enable rapid incident response (but expensive to implement and maintain).
   
   - **Known facts, assumptions, and uncertainties**: 
     - **Facts**: MPC threshold signatures inherently multi-round interactive requiring session state across rounds [Technical: MPC Protocol Nature]; Lindell17 protocol 6 rounds, GG18/20 4-5 rounds, CGGMP20 7 rounds [Protocol: Round Counts]; Session state includes: session ID, participant list, round number, accumulated messages, commitments, partial results [State: Required Context]; WebSocket (WSS) common transport for browser and mobile MPC wallets [Transport: Technology Stack]; Session hijacking via XSS token theft demonstrated in academic research [Research: XSS Session Attacks]; Replay attacks against threshold signatures possible without message nonces or sequence numbers [Research: Replay Feasibility]; State desynchronization from packet loss causes signing failures [Vulnerability: Network Reliability]; Centralized coordinators represent single point of failure if compromised or DoS'd [Architecture: SPOF Risk]; Bybit $1.4B hack 2024 involved transaction signing infrastructure compromise [Incident: Bybit 2024]; Decentralized MPC coordination technically feasible through P2P protocols but increases complexity [Architecture: P2P Possibility]; Message-level authentication (HMAC, signatures) prevents tampering but adds latency 10-50ms per round [Security: Authentication Cost]; HSTS enforcement prevents WebSocket downgrade from WSS to WS [Security: Transport Protection]; Checkpoint-restore enables session recovery after network disconnection [Mechanism: State Persistence].
     - **Assumptions**: ~40% of MPC wallets use secure session tokens with cryptographic binding (survey of major providers, no comprehensive audit data); ~60% implement replay protection through nonces (academic protocols specify, production implementation unclear); ~20% deploy decentralized/P2P coordination (minority of market, most use centralized); ~50-70% implement per-message authentication (estimated from protocol documentation, actual deployment verification limited); <10% have real-time session monitoring (few providers publicly discuss security monitoring); ~80-90% browser wallets use WSS (industry best practice, but actual enforcement uncertain); Session completion rate ~70-80% under adverse network (10% loss, 500ms latency, inferred from user reports and customer support data); 100M+ MPC wallet users globally (major providers: Coinbase 108M total, subset using MPC, ZenGo 500K, Web3Auth 10M, extrapolated to ecosystem); $50B+ assets under MPC custody (institutional + retail holdings estimated from market data); $10M-$50M annual indirect losses from signing failures (gas fees, lost opportunities, user churn, no authoritative data); $200K-$800K per-provider session security upgrade cost (engineering effort + infrastructure + audits, typical security project sizing); Message authentication adds 10-50ms latency per round (HMAC fast ~10ms, ECDSA signature slower ~50-200ms); Session monitoring infrastructure $5K-$20K annually per provider (cloud hosting, monitoring tools, alerting); P2P coordination increases bandwidth n² vs. n for centralized (combinatorial connections); TURN relay servers for NAT traversal $0.001-0.01 per session (WebRTC pricing models).
     - **Uncertainties**: What is actual prevalence of secure session management in production MPC wallets? (Providers don't disclose implementation details, security audits confidential, no public transparency); Have any successful session hijacking attacks occurred in wild? (No public reports, but attribution difficult—could signed transaction have been hijacked vs. user initiated? No forensic evidence); What is true session completion success rate across different network conditions? (Anecdotal reports suggest 70-80% under poor network, but no systematic measurement); What percentage of MPC wallets implement per-message authentication? (50-70% estimate from documentation review, but actual deployment verification requires penetration testing across all providers); How effective is replay protection in practice? (Protocols specify nonces, but implementation bugs may allow replay—needs systematic testing); What is optimal session timeout balance? (Too short = false failures, too long = attack window, varies by use case but no data-driven optimization); Can YOSO (You Only Speak Once) stateless MPC replace session-based protocols? (Theoretically elegant but computationally expensive, practical viability for wallet scale unknown); Will decentralized coordination adoption increase beyond current 20%? (P2P complexity discourages adoption, but coordinator SPOF risk drives demand—trajectory uncertain); What is user tolerance for signing latency increases from security measures? (Message auth + retry adds 5-10s, acceptable for infrequent transactions but problematic for DeFi high-frequency?); Can machine learning anomaly detection effectively identify session hijacking? (Promising but false positive rate and adversarial evasion techniques unknown); What is liability framework for signing failures? (User transaction fails due to coordinator DoS—is provider liable? Force majeure? Insurance coverage?); Should regulators mandate session security standards for MPC custody? (Financial authorities scrutinizing custody security, but prescriptive standards may stifle innovation—regulatory approach uncertain).

---

## Glossary

- **CGGMP20**: UC Non-Interactive, Proactive, Threshold ECDSA protocol by Canetti, Gennaro, Goldfeder, Makriyannis, Peled (2020) requiring 7 interactive rounds for threshold signing with enhanced security properties.
- **Checkpoint-restore**: Session recovery mechanism periodically saving protocol state (every round or subset of rounds) enabling resumption from last checkpoint after network disconnection or failure.
- **GG18/GG20**: Threshold ECDSA protocols by Gennaro and Goldfeder (2018, 2020) requiring 4-5 interactive rounds for n-of-n or t-of-n signing.
- **Lindell17**: Two-party ECDSA protocol by Yehuda Lindell (2017) requiring 6 interactive rounds for 2-of-2 threshold signatures, widely used in consumer MPC wallets.
- **Message authentication**: Cryptographic verification (HMAC or digital signature) applied to each protocol message ensuring integrity and authenticity, preventing tampering and injection.
- **P2P (peer-to-peer) coordination**: Decentralized MPC session management where parties communicate directly without centralized coordinator, using gossip protocols or direct connections.
- **Replay attack**: Attacker captures legitimate protocol messages from previous signing session and replays them in current session exploiting insufficient message uniqueness (missing nonces, session IDs, timestamps).
- **Session desynchronization**: Protocol parties diverge in session state (different round numbers, missing messages) due to network issues or malicious manipulation, causing signing failure requiring restart.
- **Session hijacking**: Attacker intercepts session authentication tokens (cookies, JWTs) through XSS, MITM, or theft, impersonates legitimate party, injects malicious messages into signing protocol.
- **Session token**: Cryptographic credential (JWT with session ID + nonce + expiry) authenticating party's participation in specific signing session, preventing reuse across sessions.
- **WebSocket Secure (WSS)**: Encrypted WebSocket connection over TLS providing confidentiality and integrity for real-time bi-directional messaging, used by browser and mobile MPC wallets.
- **YOSO (You Only Speak Once)**: MPC protocol design where parties are stateless, sending one message each without requiring subsequent interaction, eliminating session management complexity but increasing computational cost.

---

## Reference

### Technical Documentation & Guides
- [Guide: Stackup MPC, 2024] - "MPC Wallets: A Complete Technical Guide" covering protocol rounds and session requirements (https://www.stackup.fi/resources/mpc-wallets-a-complete-technical-guide)
- [Technical: MPC Protocol Rounds] - Lindell17, GG18/20, CGGMP20 round complexity and message exchange specifications
- [Technical: Session Management Requirements] - Session state persistence, authenticated transport, synchronized progression, timeout handling, failure recovery
- [Protocol: Lindell17] - Yehuda Lindell 2017 "Fast Secure Two-Party ECDSA Signing" 6-round protocol specification
- [Protocol: GG18/20] - Gennaro & Goldfeder 2018/2020 threshold ECDSA 4-5 round protocols
- [Protocol: CGGMP20] - Canetti et al. 2020 "UC Non-Interactive, Proactive, Threshold ECDSA" 7-round protocol

### Attack Vectors & Vulnerabilities
- [Attack: Session Hijacking] - XSS-based token theft, MITM downgrade, impersonation techniques targeting MPC sessions
- [Vulnerability: State Desync] - Network latency, packet loss, malicious manipulation causing protocol state divergence
- [Attack: Replay] - Captured message reuse exploiting insufficient uniqueness, nonce/session ID validation gaps
- [Attack: Selective DoS] - Connection disruption targeting threshold minority preventing signature completion
- [Vulnerability: Coordinator Compromise] - Centralized MPC backend as single point of failure enabling message logging, selective dropping, injection
- [Attack: XSS Session Theft] - Malicious JavaScript injection stealing WebSocket tokens from browser context
- [Attack: MITM Downgrade] - TLS downgrade from WSS to WS enabling eavesdropping and active message injection
- [Attack: Message Dropping] - Selective packet dropping inducing state desynchronization and protocol abort
- [Attack: Threshold DoS] - Bandwidth saturation preventing threshold achievement for time-sensitive transactions
- [Attack: Coordinator Breach] - Compromised centralized coordinator enabling offline cryptanalysis, selective failures, transaction manipulation
- [Vulnerability: Token Security] - XSS, MITM, token reuse vulnerabilities in WebSocket authentication

### Research Papers
- [Research: Threshold Signature Replay] - Academic demonstrations of replay attacks against naive threshold implementations missing nonces
- [Research: MPC Cache Timing] - Cache-timing side-channels leaking MPC coordination server partial session state
- [Research: YOSO MPC 2021] - "YOSO: You Only Speak Once / Secure MPC with Stateless Ephemeral Roles" (https://eprint.iacr.org/2021/210)
- [Research: Chat Sessions 2024] - "Stateful Communication with Malicious Parties" formalizing secure session management (https://eprint.iacr.org/2024/1593)
- [Research: XSS Session Attacks] - Academic research on XSS-based session token theft in web applications

### Security Incidents
- [Incident: Bybit 2024] - $1.4B Bybit hack involving transaction signing infrastructure compromise, potential session attack component
- [Research: BitForge 2023] - Fireblocks key extraction vulnerabilities disclosure including session management improvements

### Architecture & Design
- [Architecture: Centralized] - Single coordinator orchestrating protocol rounds, reliable ordering, single point of failure
- [Architecture: P2P] - Peer-to-peer direct communication, distributed state, no SPOF, increased complexity
- [Architecture: Hybrid] - Coordinator routing with end-to-end encryption and mutual authentication
- [Architecture: SPOF Risk] - Centralized coordinator vulnerability analysis
- [Architecture: P2P Possibility] - Technical feasibility and tradeoffs of decentralized MPC coordination

### Transport & Security
- [Transport: Connection Types] - WebSocket (WSS), HTTPS long-polling, dedicated TLS, VPN tunnels for MPC
- [Security: WebSocket Auth] - JWT tokens, session cookies, message HMAC, session binding
- [Security: Transport Protection] - HSTS enforcement, certificate pinning, WSS-only mode
- [Security: Authentication Cost] - Message-level HMAC/signature latency overhead measurements

### Session State & Recovery
- [State: Session Context] - Ephemeral state requirements: session ID, participants, round number, accumulated messages, commitments, timestamps, nonces
- [State: Required Context] - Complete session state specification for threshold signature protocols
- [Challenge: State Persistence] - State survival across network disconnections, consistency across parties
- [Mechanism: State Persistence] - Checkpoint-restore implementation strategies

### Market Landscape
- [Market: Session Security Adoption] - Industry adoption rates for secure tokens, replay protection, decentralized coordination, monitoring
- [Market: Session Security Landscape] - Current implementation statistics and security posture across providers

### Performance & Constraints
- [Constraint: Performance Impact] - Latency overhead from authentication, storage from checkpointing, bandwidth from P2P
- [Constraint: Network Variability] - Mobile cellular vs. institutional fiber network characteristics affecting MPC reliability
- [Constraint: Migration Complexity] - Backward compatibility challenges in coordinated session protocol upgrades
- [Constraint: Decentralization Cost] - Server cost elimination vs. client battery/bandwidth consumption tradeoffs
- [Constraint: Security-UX Balance] - Session timeout, retry aggressiveness, monitoring infrastructure cost tradeoffs
- [Performance: Overhead] - Quantified latency, storage, bandwidth impact of session security measures
- [Network: Heterogeneity] - Packet loss, latency, firewall, NAT characteristics across deployment environments

### Financial Impact
- [Impact: Failed Signing Costs] - Gas fees on failed transactions, lost DeFi opportunities, user abandonment economic impact
- [Financial: Session Risk] - Asset exposure, individual attack potential, systematic campaign losses, indirect costs

### Regulatory & Compliance
- [Regulatory: Session Compliance] - Audit log requirements, tamper-evidence, GDPR data residency, cross-border jurisdictional issues

### Surface Analysis
- [Surface: Session Vulnerabilities] - Comprehensive attack surface taxonomy for MPC session management
- [Vulnerability: Network Reliability] - Packet loss, latency, disconnection impact on signing success rates
- [Vulnerability: Replay Feasibility] - Conditions enabling successful replay attacks in practice
