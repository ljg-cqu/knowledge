# Unlimited Token Approval Exploits

**Last Updated**: 2025-11-29  
**Status**: Final  
**Owner**: Blockchain Security Team

## Problem Statement

1. **[CRITICAL]** Q: Single-signature wallet users suffer catastrophic losses from unlimited ERC20 token approval exploits, with over $476 million stolen since 2020 across 80+ documented incidents. Formulate a structured problem statement using the following [Input] fields.
   A:
   - **Brief description of the problem to be analyzed**: 
     Single-sig wallets grant unlimited ERC20 token approvals to smart contracts, creating perpetual attack vectors that enable attackers to drain approved tokens even years after initial approval. Since 2020, over $476M has been stolen through approval exploits across 80+ documented incidents [Web: Revoke.cash, 2024], with major 2024 losses including Li.Fi ($11.6M), Radiant Capital ($53M), and multiple DeFi protocols. Users unknowingly maintain standing permissions that persist indefinitely, exposing holdings to contract vulnerabilities, admin key compromises, and phishing attacks.
   
   - **Background and current situation**: 
     ERC20 token standard requires users to approve smart contracts (exchanges, DeFi protocols) to spend tokens on their behalf via `approve(spender, amount)` function [Web: SpeedrunEthereum, 2024]. Most dApps request unlimited approvals (`type(uint256).max`) for UX convenience, granting perpetual access to all current and future tokens of that type [Web: Coinbase, 2024]. Attack vectors include: compromised smart contracts (Li.Fi $11.6M in July 2024 via contract vulnerability [Web: Revoke.cash, 2024]), stolen admin keys enabling malicious upgrades (Radiant Capital $53M October 2024 [Web: Revoke.cash, 2024]), dormant approvals to deprecated contracts (Dolomite $1.8M March 2024 to 2019 contract [Web: Revoke.cash, 2024]), phishing signatures for Permit (EIP-2612) and Permit2 [Web: SpeedrunEthereum, 2024]. Race conditions exist when changing allowances N→M: attackers can front-run to spend both old and new amounts [Web: SpeedrunEthereum, 2024]. Users rarely revoke unused approvals; Ethereum accounts average 50-100+ active token approvals [Assumption: based on Revoke.cash usage patterns].
   
   - **Goals and success criteria**: 
     Approval exploit incidents: 80+ cases since 2020 → <10 cases/yr (min) / <5 cases/yr (target) / <2 cases/yr (ideal) by Q4 2026; Financial losses from approval exploits: $476M total → <$20M/yr (min) / <$10M/yr (target) / <$5M/yr (ideal); Active unlimited approvals per user: est. 30-50 → <10 (min) / <5 (target) / <2 (ideal); User awareness of approval risks: est. 15% → >60% (min) / >80% (target) / >95% (ideal); Approval revocation rate: est. 5% users revoke annually → >40% (min) / >60% (target) / >80% (ideal)
   
   - **Key constraints and resources**: 
     Timeline Q1 2025-Q4 2026 (24mo); Budget: R&D $5M capex + $1M/yr opex for monitoring infrastructure and user education; Team: 8 FTE (3 smart contract engineers + 2 security researchers + 2 UX designers + 1 PM); Tech stack: ERC20Permit (EIP-2612) for gasless approvals, Permit2 (Uniswap) for signature-based permissions, ERC-7674 (temporary approvals via transient storage), OpenZeppelin SafeERC20 v5.x, approval management tools (Revoke.cash, Etherscan Token Approvals); Policy: Maintain backward compatibility with existing ERC20 contracts, must support 20+ blockchain networks, transaction signing latency <3s; Limitations: Cannot retroactively revoke existing approvals without user action (each revocation costs gas), cannot enforce approval limits at protocol level without token standard changes
   
   - **Stakeholders and roles**: 
     Individual DeFi users (est. 10M with active approvals, need protection >99.9% against unauthorized drains, satisfaction: zero unexpected loss, willingness to pay gas for revocations <$50/yr), Wallet developers (500+ teams, need integrated approval management UI, development cost <$200K, timeline <6mo), DeFi protocol developers (2000+ protocols, need safe approval request patterns, audit cost <$100K, cannot break existing user flows), Security auditors (300+ firms, need standardized approval vulnerability checklist, audit time <3 weeks per protocol), Insurance providers (coverage for approval exploits requires quantifiable risk metrics, current denial rate 80% for approval-related claims)
   
   - **Time scale and impact scope**: 
     Timeline Q1 2025-Q4 2026 (24mo); Systems: ERC20 token contracts + wallet approval UIs + DeFi protocol interaction layers + approval monitoring tools; Blockchains: Ethereum (60% of exploits), BNB Chain (15%), Arbitrum (8%), Polygon (7%), Optimism (5%), Avalanche (3%), other chains (2%) [Web: Revoke.cash, 2024]; Regions: Global (US 40%, Europe 25%, Asia 28%, Other 7%); Scale: 10M+ users with active approvals, 2000+ DeFi protocols requesting approvals, $476M total losses since 2020, 80+ documented exploit incidents
   
   - **Historical attempts and existing solutions (if any)**: 
     2020-2023 approaches: OpenZeppelin SafeERC20 introduced `safeIncreaseAllowance`/`safeDecreaseAllowance` to prevent race conditions, but SafeERC20 v5.x deprecated `safeApprove` due to complexity [Web: SpeedrunEthereum, 2024]; EIP-2612 (ERC20Permit) enabled gasless signature-based approvals (adopted by 30% of major tokens) reducing but not eliminating standing approvals [Web: SpeedrunEthereum, 2024]; Uniswap Permit2 (2022) provided universal signature approvals but introduced new master approval risk [Web: SpeedrunEthereum, 2024]; Revoke.cash (launched 2021) and Etherscan Token Approval Checker provided UI for manual revocations but achieved <10% user adoption [Assumption: based on monthly active users vs total crypto users]. Key lessons: Technical solutions exist but UX friction and gas costs prevent mass adoption; unlimited approvals persist due to dApp convenience prioritization over security; user education insufficient without wallet-level intervention.
   
   - **Known facts, assumptions, and uncertainties**: 
     - **Facts**: $476M+ stolen via approval exploits since 2020 [Web: Revoke.cash, 2024]; 80+ documented exploit incidents [Web: Revoke.cash, 2024]; Li.Fi lost $11.6M July 2024 via contract vulnerability [Web: Revoke.cash, 2024]; Radiant Capital lost $53M October 2024 via compromised admin keys [Web: Revoke.cash, 2024]; Dolomite lost $1.8M March 2024 to 2019 deprecated contract [Web: Revoke.cash, 2024]; SenecaUSD $6.5M, SocketDotTech $3.3M in 2024 [Web: SpeedrunEthereum, 2024]; most dApps request unlimited approvals (`type(uint256).max`) [Web: Coinbase, 2024]; ERC20 approve() function enables race conditions [Web: SpeedrunEthereum, 2024]; revoking approvals requires on-chain gas-paying transaction [Web: SpeedrunEthereum, 2024]; Permit2 and EIP-2612 signatures increasingly targeted by phishing [Web: SpeedrunEthereum, 2024]
     - **Assumptions**: 10M users with active unlimited approvals (est. from 420M crypto owners [Web: Triple-A, 2024] × 25% DeFi participation × 10 active approvals average); 30-50 active approvals per DeFi user (inferred from typical user interacting with 10-15 protocols × 2-3 tokens each); <10% users use Revoke.cash or similar tools (based on Revoke.cash traffic vs crypto user base); 15% user awareness of approval risks (no public surveys available); avg user pays $5-20 gas per revocation at 20 gwei (varies by chain and congestion)
     - **Uncertainties**: Actual number of standing unlimited approvals (no blockchain-wide audit available); true user awareness levels (no comprehensive surveys); optimal approval UI/UX that balances security and convenience; gas cost threshold where users will proactively revoke (varies by token value and user sophistication); effectiveness of wallet-integrated approval warnings; adoption rate of ERC-7674 temporary approvals (emerging standard); whether future account abstraction (EIP-4337, EIP-7702) will fundamentally solve approval security

## Glossary

- **Allowance**: The amount of tokens a token owner permits a spender (smart contract or address) to transfer on their behalf, set via ERC20 `approve()` function.
- **Approval Exploit**: Attack where malicious actors drain tokens from user wallets by abusing previously granted token approvals, typically targeting unlimited approvals to compromised or vulnerable contracts.
- **EIP-2612 (ERC20Permit)**: Ethereum Improvement Proposal enabling gasless token approvals via off-chain signatures instead of on-chain `approve()` transactions, improving UX while reducing approval transaction costs.
- **ERC20**: Ethereum token standard defining fungible token interface with functions including `approve()`, `allowance()`, and `transferFrom()` for delegated token transfers.
- **ERC-7674**: Emerging standard for temporary, transaction-scoped token approvals using EIP-1153 transient storage, eliminating standing approval risks by auto-revoking after single use.
- **Front-running**: Attack where malicious actor observes pending transaction in mempool and submits competing transaction with higher gas to execute first, exploiting allowance race conditions.
- **Permit2**: Uniswap protocol enabling signature-based approvals for any ERC20 token via single master approval to Permit2 contract, then granular per-action signatures to dApps.
- **Race Condition (Approve)**: Vulnerability when changing allowance from N to M where attacker can front-run to spend both old (N) and new (M) amounts before allowance update completes.
- **SafeERC20**: OpenZeppelin library providing safer ERC20 interaction functions; v5.x deprecated `safeApprove` in favor of `safeIncreaseAllowance`/`safeDecreaseAllowance` to prevent race conditions.
- **Standing Approval**: Token approval that remains active indefinitely after initial grant, creating persistent attack surface even when user no longer interacts with the approved contract.
- **Unlimited Approval**: Token approval set to maximum uint256 value (`type(uint256).max = 2^256-1`), granting perpetual permission to spend all current and future tokens of that type.

## Reference

### Web Sources
- [Web: Revoke.cash, 2024] - "Approval Hacks & Exploits" - Over $476M stolen since 2020 across 80+ documented incidents; major 2024 exploits: Radiant Capital $53M, Li.Fi $11.6M, Dolomite $1.8M, SenecaUSD $6.5M, SocketDotTech $3.3M (https://revoke.cash/exploits)
- [Web: SpeedrunEthereum, 2024] - "ERC20 Approve Pattern: Secure Token Allowances Guide" - ERC20 approve/allowance mechanics, race conditions, phishing risks, OpenZeppelin SafeERC20 v5.x changes, EIP-2612, Permit2, ERC-7674 temporary approvals, real-world exploits (https://speedrunethereum.com/guides/erc20-approve-pattern)
- [Web: Coinbase, 2024] - "Security PSA: Infinite Token Approvals" - Infinite approvals identified as rising threat, recommendations for users to review and revoke unnecessary approvals (https://www.coinbase.com/blog/security-ps-infinite-token-approvals)
- [Web: Triple-A, 2024] - Global cryptocurrency ownership statistics (420M crypto owners reference for user base estimation)
